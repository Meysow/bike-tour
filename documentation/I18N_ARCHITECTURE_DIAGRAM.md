# i18n Architecture - Visual Reference

## ğŸ”„ Request Flow Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           USER BROWSER                                   â”‚
â”‚                                                                          â”‚
â”‚  User types: rentabikeparis.fr/visite-guidee-de-paris-a-velo           â”‚
â”‚  Browser language: fr-FR                                                â”‚
â”‚  Cookie: NEXT_LOCALE=fr (if exists)                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NEXT.JS MIDDLEWARE                                â”‚
â”‚                      (src/middleware.ts)                                 â”‚
â”‚                                                                          â”‚
â”‚  Step 1: Detect Preferred Locale                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                    â”‚
â”‚  â”‚ 1. Check Cookie (NEXT_LOCALE)  â”‚ â”€â”€â”€ Found: fr âœ“                   â”‚
â”‚  â”‚ 2. Check Accept-Language       â”‚                                     â”‚
â”‚  â”‚ 3. Use default (fr)            â”‚                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                    â”‚
â”‚                                                                          â”‚
â”‚  Step 2: Parse URL Path                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚  â”‚ URL: /visite-guidee-de-paris-a-velo                â”‚               â”‚
â”‚  â”‚                                                      â”‚               â”‚
â”‚  â”‚ Check routes configuration:                         â”‚               â”‚
â”‚  â”‚ routes.tours.fr = "/visite-guidee-de-paris-a-velo" â”‚ â”€â”€â”€ MATCH! âœ“  â”‚
â”‚  â”‚ routes.tours.filePath = "/tours"                    â”‚               â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â”‚                                                                          â”‚
â”‚  Step 3: URL Rewrite                                                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                             â”‚
â”‚  â”‚ Original: /visite-guidee-de-paris    â”‚                             â”‚
â”‚  â”‚ Rewrite:  /fr/tours                  â”‚ â”€â”€â”€â”€â”€â”€â”                     â”‚
â”‚  â”‚ Set Cookie: NEXT_LOCALE=fr           â”‚       â”‚                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                    â”‚
                                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        NEXT.JS APP ROUTER                                â”‚
â”‚                                                                          â”‚
â”‚  Serves: app/[locale]/tours/page.tsx                                    â”‚
â”‚  Params: { locale: "fr" }                                               â”‚
â”‚                                                                          â”‚
â”‚  Layout Wrapper: app/[locale]/layout.tsx                                â”‚
â”‚  â”œâ”€ Validates locale                                                    â”‚
â”‚  â”œâ”€ Loads translations: i18n/fr.json                                   â”‚
â”‚  â””â”€ Provides locale context                                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      PAGE COMPONENT RENDERS                              â”‚
â”‚                   (app/[locale]/tours/page.tsx)                         â”‚
â”‚                                                                          â”‚
â”‚  Uses:                                                                   â”‚
â”‚  â”œâ”€ useLocalizedRoutes() â”€â”€â”€â–º Gets current locale (fr)                 â”‚
â”‚  â”œâ”€ createLink("rent") â”€â”€â”€â”€â”€â–º Returns: "/location-velo-paris"          â”‚
â”‚  â””â”€ getNavItems(locale) â”€â”€â”€â”€â–º Returns nav items in French              â”‚
â”‚                                                                          â”‚
â”‚  Renders: French content with French URLs                               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”€ Language Switching Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       USER ON FRENCH PAGE                                â”‚
â”‚  Current URL (visible): /visite-guidee-de-paris-a-velo                 â”‚
â”‚  Current locale: fr                                                      â”‚
â”‚  Current cookie: NEXT_LOCALE=fr                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â”‚ User clicks language switcher â†’ English
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LANGUAGE SWITCHER COMPONENT                           â”‚
â”‚                 (src/components/shared/language-switcher.tsx)           â”‚
â”‚                                                                          â”‚
â”‚  const switchLanguage = (newLocale: "en") => {                          â”‚
â”‚    1. Set cookie: NEXT_LOCALE=en                                        â”‚
â”‚    2. Get equivalent URL:                                                â”‚
â”‚       getLanguageSwitchUrl("en")                                        â”‚
â”‚       â”œâ”€ Current path: /visite-guidee-de-paris-a-velo                  â”‚
â”‚       â”œâ”€ Current locale: fr                                              â”‚
â”‚       â”œâ”€ Match to: routes.tours                                         â”‚
â”‚       â””â”€ Return: routes.tours.en = "/guided-bike-tour-paris"           â”‚
â”‚    3. Navigate to: /guided-bike-tour-paris                              â”‚
â”‚  }                                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        BROWSER NAVIGATION                                â”‚
â”‚  Navigates to: /guided-bike-tour-paris                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         MIDDLEWARE AGAIN                                 â”‚
â”‚  Path: /guided-bike-tour-paris                                          â”‚
â”‚  Cookie: NEXT_LOCALE=en (just set)                                     â”‚
â”‚  Match: routes.tours.en                                                 â”‚
â”‚  Rewrite to: /en/tours                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
                             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      SAME PAGE, ENGLISH VERSION                          â”‚
â”‚  URL (visible): /guided-bike-tour-paris                                 â”‚
â”‚  Locale: en                                                              â”‚
â”‚  Content: English                                                        â”‚
â”‚  Links: All English URLs                                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“Š Component Interaction Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           CONFIGURATION LAYER                             â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  config/i18n.ts â”‚  â”‚ config/routes.ts â”‚  â”‚ config/navigation.tsâ”‚   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤   â”‚
â”‚  â”‚ â€¢ locales []    â”‚  â”‚ â€¢ routes map     â”‚  â”‚ â€¢ nav labels        â”‚   â”‚
â”‚  â”‚ â€¢ defaultLocale â”‚  â”‚ â€¢ getLocalized   â”‚  â”‚ â€¢ getNavItems()     â”‚   â”‚
â”‚  â”‚ â€¢ isValidLocale â”‚  â”‚ â€¢ getFromPath    â”‚  â”‚                     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                    â”‚                       â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                 â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                                         â”‚
            â–¼                                         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   MIDDLEWARE LAYER      â”‚              â”‚   TRANSLATION LAYER         â”‚
â”‚   (Server-side)         â”‚              â”‚   (Server & Client)         â”‚
â”‚                         â”‚              â”‚                             â”‚
â”‚  src/middleware.ts      â”‚              â”‚  i18n/request.ts            â”‚
â”‚  â”œâ”€ URL detection       â”‚              â”‚  â”œâ”€ next-intl config        â”‚
â”‚  â”œâ”€ Locale detection    â”‚              â”‚  â””â”€ Load translations       â”‚
â”‚  â”œâ”€ URL rewriting       â”‚              â”‚                             â”‚
â”‚  â””â”€ Cookie management   â”‚              â”‚  i18n/*.json                â”‚
â”‚                         â”‚              â”‚  â”œâ”€ en.json                 â”‚
â”‚                         â”‚              â”‚  â”œâ”€ fr.json                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”œâ”€ de.json                 â”‚
             â”‚                           â”‚  â”œâ”€ nl.json                 â”‚
             â”‚                           â”‚  â””â”€ es.json                 â”‚
             â”‚                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚                                        â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                            HOOK LAYER                                     â”‚
â”‚                          (Client-side)                                    â”‚
â”‚                                                                           â”‚
â”‚  hooks/use-localized-routes.ts                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  export function useLocalizedRoutes() {                           â”‚   â”‚
â”‚  â”‚    const pathname = usePathname();                                â”‚   â”‚
â”‚  â”‚    const locale = useLocale();  // Detect from URL/params         â”‚   â”‚
â”‚  â”‚                                                                    â”‚   â”‚
â”‚  â”‚    return {                                                        â”‚   â”‚
â”‚  â”‚      locale,                      // Current locale               â”‚   â”‚
â”‚  â”‚      createLink(routeKey),        // Generate localized link      â”‚   â”‚
â”‚  â”‚      getLanguageSwitchUrl(locale) // Get URL for lang switch      â”‚   â”‚
â”‚  â”‚    }                                                               â”‚   â”‚
â”‚  â”‚  }                                                                 â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                     â”‚
                                     â”‚ Used by â†“
                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         COMPONENT LAYER                                   â”‚
â”‚                                                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Header            â”‚  â”‚  Hero Section      â”‚  â”‚  Footer          â”‚  â”‚
â”‚  â”‚  â€¢ Navigation      â”‚  â”‚  â€¢ CTA Buttons     â”‚  â”‚  â€¢ Links         â”‚  â”‚
â”‚  â”‚  â€¢ Lang Switcher   â”‚  â”‚  â€¢ Localized links â”‚  â”‚  â€¢ Legal links   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                           â”‚
â”‚  All use: const { locale, createLink } = useLocalizedRoutes()            â”‚
â”‚  All generate: Properly localized URLs                                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ—ºï¸ Route Resolution Example

```
INPUT: User visits /location-velo-paris
              â”‚
              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 1: Middleware receives request                 â”‚
â”‚  pathname = "/location-velo-paris"                   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 2: Check if pathname has locale prefix         â”‚
â”‚  Does "/location-velo-paris" start with              â”‚
â”‚  /en/, /fr/, /de/, /nl/, or /es/?                    â”‚
â”‚  â†’ NO                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 3: Search in routes configuration              â”‚
â”‚                                                       â”‚
â”‚  FOR each route in routes:                           â”‚
â”‚    Check if pathname matches any locale:             â”‚
â”‚                                                       â”‚
â”‚    routes.home[*]  = "/"                             â”‚
â”‚    âŒ No match                                        â”‚
â”‚                                                       â”‚
â”‚    routes.tours[*] = "/...-tour-paris"               â”‚
â”‚    âŒ No match                                        â”‚
â”‚                                                       â”‚
â”‚    routes.rent[*]  = "/...-rental-paris"             â”‚
â”‚    â”œâ”€ routes.rent.en = "/bike-rental-paris"         â”‚
â”‚    â”‚  âŒ No match                                     â”‚
â”‚    â”œâ”€ routes.rent.fr = "/location-velo-paris"       â”‚
â”‚    â”‚  âœ… MATCH!                                       â”‚
â”‚    â”‚                                                  â”‚
â”‚    â””â”€â–º Found: locale=fr, filePath=/rent              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 4: URL Rewrite                                 â”‚
â”‚  Original URL: /location-velo-paris                  â”‚
â”‚  Internal URL: /fr/rent                              â”‚
â”‚  Cookie: Set NEXT_LOCALE=fr                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  STEP 5: Next.js renders page                        â”‚
â”‚  File: app/[locale]/rent/page.tsx                    â”‚
â”‚  Params: { locale: "fr" }                            â”‚
â”‚  Result: French rental page                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ§© File Structure with Data Flow

```
src/
â”œâ”€â”€ middleware.ts â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”‚   (Intercepts all requests)       â”ƒ
â”‚   Uses: config/i18n.ts             â”ƒ
â”‚   Uses: config/routes.ts           â”ƒ
â”‚                                    â”ƒ
â”œâ”€â”€ config/                          â”ƒ
â”‚   â”œâ”€â”€ i18n.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‹â”€â”€â”€ Central locale config
â”‚   â”‚   Exports: locales, default    â”ƒ
â”‚   â”‚                                 â”ƒ
â”‚   â”œâ”€â”€ routes.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‹â”€â”€â”€ URL mappings
â”‚   â”‚   Exports: routes, helpers     â”ƒ
â”‚   â”‚                                 â”ƒ
â”‚   â””â”€â”€ navigation.ts                â”ƒ
â”‚       Exports: getNavItems()       â”ƒ
â”‚                                    â”ƒ
â”œâ”€â”€ app/                              â”ƒ
â”‚   â””â”€â”€ [locale]/ â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‹â”€â”€â”€ Receives rewritten URL
â”‚       â”œâ”€â”€ layout.tsx               â”ƒ     Params: { locale }
â”‚       â”‚   Validates locale         â”ƒ
â”‚       â”‚   Loads translations       â”ƒ
â”‚       â”‚                             â”ƒ
â”‚       â”œâ”€â”€ page.tsx                 â”ƒ
â”‚       â”œâ”€â”€ tours/                   â”ƒ
â”‚       â”œâ”€â”€ rent/                    â”ƒ
â”‚       â””â”€â”€ blog/                    â”ƒ
â”‚                                    â”ƒ
â”œâ”€â”€ hooks/                            â”ƒ
â”‚   â””â”€â”€ use-localized-routes.ts â—„â”€â”€â”€â”€â•‹â”€â”€â”€ Client-side routing
â”‚       Uses: config/routes.ts       â”ƒ
â”‚       Uses: lib/utils/navigation   â”ƒ
â”‚                                    â”ƒ
â”œâ”€â”€ lib/utils/                        â”ƒ
â”‚   â”œâ”€â”€ navigation.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‹â”€â”€â”€ Helper functions
â”‚   â”‚   createLocalizedLink()        â”ƒ
â”‚   â”‚   getAlternateLanguageUrl()    â”ƒ
â”‚   â”‚                                 â”ƒ
â”‚   â”œâ”€â”€ hreflang.ts                  â”ƒ
â”‚   â”‚   generatePageMetadata() â”ƒ
â”‚   â”‚                                 â”ƒ
â”‚   â””â”€â”€ metadata.ts                  â”ƒ
â”‚       generatePageMetadata()       â”ƒ
â”‚                                    â”ƒ
â”œâ”€â”€ i18n/                             â”ƒ
â”‚   â”œâ”€â”€ request.ts â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•‹â”€â”€â”€ next-intl config
â”‚   â”‚   Loads translation files      â”ƒ
â”‚   â”‚                                 â”ƒ
â”‚   â””â”€â”€ [locale].json â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”›
â”‚       Translation content
â”‚       (Currently underutilized)
```

## ğŸ¯ Key Concepts Summary

### URL Rewriting (not Redirecting)

```
âŒ REDIRECT (301/302) - Bad for UX
User sees: /location-velo-paris
â†“ 302 Redirect
Browser changes to: /fr/rent
User sees URL change âš ï¸

âœ… REWRITE - Good for UX
User sees: /location-velo-paris
â†“ Internal rewrite
Server serves: /fr/rent
User still sees: /location-velo-paris âœ“
```

### Locale Detection Priority

```
1st Priority: Cookie (NEXT_LOCALE)
â””â”€ Persistent across visits (1 year)
â””â”€ Set on every navigation

2nd Priority: Accept-Language Header
â””â”€ Browser's language preference
â””â”€ Example: "fr-FR,fr;q=0.9,en;q=0.8"
â””â”€ Uses first language code: "fr"

3rd Priority: Default (fr)
â””â”€ Fallback if nothing else matches
```

### Route Matching Logic

```
routes = {
  tours: {
    en: "/guided-bike-tour-paris",
    fr: "/visite-guidee-de-paris-a-velo",
    filePath: "/tours"
  }
}

Input: "/visite-guidee-de-paris-a-velo"
Process:
  1. Loop through all routes
  2. Loop through all locales for each route
  3. Find match: routes.tours.fr === input
  4. Extract: locale=fr, filePath=/tours
  5. Rewrite: /fr/tours
```

---

## ğŸ“ Quick Reference

**Adding a new page?**

1. Create: `app/[locale]/newpage/page.tsx`
2. Add to: `config/routes.ts`
   ```typescript
   newpage: {
     en: "/english-url",
     fr: "/url-francais",
     de: "/deutsche-url",
     nl: "/nederlandse-url",
     es: "/url-espanol",
     filePath: "/newpage",
   }
   ```
3. Add navigation label (optional): `config/navigation.ts`

**Creating localized links?**

```typescript
const { createLink } = useLocalizedRoutes();
<Link href={createLink("tours")}>Tours</Link>;
```

**Switching languages?**

```typescript
const { getLanguageSwitchUrl } = useLocalizedRoutes();
const newUrl = getLanguageSwitchUrl("en");
router.push(newUrl);
```

---

For full details, see `I18N_COMPREHENSIVE_GUIDE.md`
